{%- style -%}
  .menu-drawer {
    position: fixed;
    transform: translateX(-100%);
    visibility: hidden;
    z-index: 100;
    left: 0;
    top: 0;
    width: 100%;
    height: 100vh;
    overflow-x: hidden;
    background-color: {{ section.settings.drawer_bg_color | default: '#ffffff' }};
    transition: transform 0.3s ease-in-out, visibility 0s linear 0.3s;
    box-shadow: 4px 0 10px rgba(0, 0, 0, 0.1);
  }

  .menu-drawer.is-open {
    transform: translateX(0);
    visibility: visible;
    transition: transform 0.3s ease-in-out, visibility 0s linear 0s;
  }

  @media screen and (min-width: 768px) {
    .menu-drawer {
      width: 300px;
    }
  }

  .header-wrapper {
    background-color: {{ section.settings.background_color }};
    transition: background-color 0.3s ease;
  }

  .header-text {
    color: {{ section.settings.text_color }};
    transition: color 0.3s ease;
  }

  .menu-item {
    position: relative;
  }

  .menu-item::after {
    content: '';
    position: absolute;
    width: 0;
    height: 2px;
    bottom: -2px;
    left: 0;
    background-color: {{ section.settings.text_color }};
    transition: width 0.3s ease;
  }

  .menu-item:hover::after {
    width: 100%;
  }

  .icon-btn {
    transition: transform 0.2s ease;
  }

  .icon-btn:hover {
    transform: scale(1.1);
  }

  .backdrop {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.4);
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0s linear 0.3s;
    z-index: 99;
  }

  .backdrop.is-active {
    opacity: 1;
    visibility: visible;
    transition: opacity 0.3s ease, visibility 0s linear 0s;
  }
{%- endstyle -%}

{% if template != 'index' %}
  {% assign header_class = 'relative sticky top-0' %}
{% else %}
  {% assign header_class = 'fixed top-0 left-0 right-0 z-50 w-full' %}
{% endif %}


<header class="{{ header_class | default: 'fixed top-0 left-0 right-0 z-50 w-full' }}">
  <div class="header-wrapper shadow-sm">
    <div class="container mx-auto px-4">
      <div class="flex items-center justify-between h-16">
        <!-- Menu Toggle for Mobile -->
        <div class="flex items-center md:hidden">
          <button 
            class="menu-drawer__toggle icon-btn p-2 header-text" 
            type="button" 
            aria-expanded="false" 
            aria-label="Toggle menu">
            <span class="sr-only">Menu</span>
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>

        <!-- Logo Area -->
        <div class="flex items-center">
          {%- if section.settings.logo != blank -%}
            <a href="{{ routes.root_url }}" class="flex-shrink-0">
              <img 
                src="{{ section.settings.logo | img_url: 'master' }}" 
                alt="{{ shop.name }}" 
                class="h-8 w-auto"
                height=""
                width="">
            </a>
          {%- else -%}
            <a href="{{ routes.root_url }}" class="flex-shrink-0">
              <h1 class="text-lg font-bold header-text">{{ shop.name }}</h1>
            </a>
          {%- endif -%}
        </div>

        <!-- Desktop Navigation -->
        <nav class="hidden md:flex items-center space-x-6">
          {%- for link in section.settings.menu.links -%}
            <a href="{{ link.url }}" class="header-text text-sm font-medium menu-item">
              {{ link.title }}
            </a>
          {%- endfor -%}
        </nav>

        <!-- Action Icons -->
        <div class="flex items-center space-x-4">
          <button type="button" class="search-toggle icon-btn header-text" aria-label="Search">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </button>

          {%- if section.settings.show_account -%}
            <a href="{{ routes.account_url }}" class="icon-btn header-text" aria-label="Account">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
              </svg>
            </a>
          {%- endif -%}

          {%- if section.settings.show_wishlist -%}
            <button id="wishlist-toggle" class="icon-btn header-text relative" aria-label="Wishlist">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
              </svg>
              <span class="absolute -top-2 -right-2 bg-gray-700 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center wishlist-count">
                0
              </span>
            </button>
          {%- endif -%}

          <a href="{{ routes.cart_url }}" class="icon-btn header-text relative" aria-label="Cart">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
            </svg>
            <span class="absolute -top-2 -right-2 bg-gray-700 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center">
              {%- if cart != empty -%}
                {{ cart.item_count }}
              {%- else -%}
                0
              {%- endif -%}
            </span>
          </a>
        </div>
      </div>
    </div>
  </div>
</header>

<!-- Mobile Menu Drawer -->
<div id="menu-drawer" class="menu-drawer">
  <div class="p-6">
    <div class="flex justify-between items-center mb-8">
      <h2 class="text-lg font-medium header-text">Menu</h2>
      <button class="menu-drawer__close-button icon-btn header-text" aria-label="Close menu">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <nav class="mt-6">
      <ul class="space-y-6">
        {%- for link in section.settings.menu.links -%}
          <li>
            <a href="{{ link.url }}" class="block text-lg header-text hover:opacity-70 transition-opacity">
              {{ link.title }}
            </a>
          </li>
        {%- endfor -%}
      </ul>
    </nav>

    <!-- Mobile Actions -->
    <div class="mt-12 pt-6 border-t border-gray-200">
      <div class="grid grid-cols-3 gap-4 text-center">
        <a href="{{ routes.search_url }}" class="flex flex-col items-center header-text">
          <svg class="w-6 h-6 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          <span class="text-sm">Search</span>
        </a>

        {%- if section.settings.show_account -%}
          <a href="{{ routes.account_url }}" class="flex flex-col items-center header-text">
            <svg class="w-6 h-6 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
            </svg>
            <span class="text-sm">Account</span>
          </a>
        {%- endif -%}

        <a href="{{ routes.cart_url }}" class="flex flex-col items-center header-text">
          <svg class="w-6 h-6 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
          </svg>
          <span class="text-sm">Cart</span>
        </a>
      </div>
    </div>
  </div>
</div>

<!-- Backdrop for Mobile Menu -->
<div id="menu-backdrop" class="backdrop"></div>

<script>
  class HeaderNavigation {
    constructor() {
      this.menuDrawer = document.getElementById('menu-drawer');
      this.menuBackdrop = document.getElementById('menu-backdrop');
      this.toggleButtons = document.querySelectorAll('.menu-drawer__toggle');
      this.closeButton = document.querySelector('.menu-drawer__close-button');
      
      this.init();
    }

    init() {
      // Toggle menu button
      this.toggleButtons.forEach(button => {
        button.addEventListener('click', () => this.openMenuDrawer());
      });
      
      // Close button
      this.closeButton.addEventListener('click', () => this.closeMenuDrawer());
      
      // Backdrop click
      this.menuBackdrop.addEventListener('click', () => this.closeMenuDrawer());
      
      // Close on escape key
      document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape') this.closeMenuDrawer();
      });

      // Initialize wishlist functionality
      const wishlistButton = document.getElementById('wishlist-toggle');
      if (wishlistButton) {
        wishlistButton.addEventListener('click', function() {
          console.log('Wishlist clicked');
        });
      }
    }

    openMenuDrawer() {
      this.menuDrawer.classList.add('is-open');
      this.menuBackdrop.classList.add('is-active');
      document.body.classList.add('overflow-hidden');
      
      this.toggleButtons.forEach(button => {
        button.setAttribute('aria-expanded', 'true');
      });
    }

    closeMenuDrawer() {
      this.menuDrawer.classList.remove('is-open');
      this.menuBackdrop.classList.remove('is-active');
      document.body.classList.remove('overflow-hidden');
      
      this.toggleButtons.forEach(button => {
        button.setAttribute('aria-expanded', 'false');
      });
    }
  }

  // Initialize the header navigation
  document.addEventListener('DOMContentLoaded', () => {
    new HeaderNavigation();
  });
</script>

{% schema %}
{
  "name": "Minimalist Header",
  "tag": "section",
  "class": "section-header sticky top-0  z-50 ",
  "disabled_on": {
    "groups": ["aside", "footer"]
  },
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#111827"
    },
    {
      "type": "color",
      "id": "drawer_bg_color",
      "label": "Menu Drawer Background",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Header Options"
    },
    {
      "type": "checkbox",
      "id": "show_wishlist",
      "label": "Show Wishlist",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_account",
      "label": "Show Account",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Minimalist Header",
      "category": "Header"
    }
  ]
}
{% endschema %}